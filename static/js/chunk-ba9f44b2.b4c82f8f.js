(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ba9f44b2"],{"08b4":function(e,t,a){},"0952":function(e,t,a){},"223e":function(e,t,a){"use strict";a("08b4")},"3a349":function(e,t,a){"use strict";a.r(t);var o=a("7a23");const c={class:"card mb-3 pe-md-4"},n={key:0,class:"card p-2"},s={class:"text-start mb-2"};function l(e,t,a,l,r,d){const i=Object(o["resolveComponent"])("PageHeader"),m=Object(o["resolveComponent"])("FilterField"),b=Object(o["resolveComponent"])("ShopPoint"),p=Object(o["resolveComponent"])("ShopPointDetail"),O=Object(o["resolveComponent"])("Layout");return Object(o["openBlock"])(),Object(o["createBlock"])(O,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(i,{title:r.title,items:r.items},null,8,["title","items"]),Object(o["createElementVNode"])("div",c,[Object(o["createVNode"])(m,{onSearchShopPoint:d.getShopPoint},null,8,["onSearchShopPoint"])]),e.shop_pointsUsage?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",n,[Object(o["createElementVNode"])("ul",s,[Object(o["createElementVNode"])("li",null,"企業別："+Object(o["toDisplayString"])(e.shop_pointInfo.conglomerate),1),Object(o["createElementVNode"])("li",null,"公司別："+Object(o["toDisplayString"])(e.shop_pointInfo.company),1),Object(o["createElementVNode"])("li",null,"門市別："+Object(o["toDisplayString"])(e.shop_pointInfo.shop),1),Object(o["createElementVNode"])("li",null,"分析日期："+Object(o["toDisplayString"])(e.shop_pointInfo.dateRange),1)]),r.showDetail?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(b,{key:0,onViewDetail:d.viewDetail},null,8,["onViewDetail"])),r.showDetail?(Object(o["openBlock"])(),Object(o["createBlock"])(p,{key:1,data:r.detailData,onGoBack:t[0]||(t[0]=e=>r.showDetail=!1)},null,8,["data"])):Object(o["createCommentVNode"])("",!0)])):Object(o["createCommentVNode"])("",!0)]),_:1})}var r=a("6a34"),d=a("2579");const i=e=>(Object(o["pushScopeId"])("data-v-1ac11ddc"),e=e(),Object(o["popScopeId"])(),e),m={class:"table-responsive"},b={class:"reportTable table table-hover table-bordered table-bordered",ref:"table"},p={class:"bg-light"},O=i(()=>Object(o["createElementVNode"])("tr",{class:"d-none"},[Object(o["createElementVNode"])("th",{colspan:"6"},"門市點數履歷")],-1)),E=i(()=>Object(o["createElementVNode"])("tr",{class:"d-none"},[Object(o["createElementVNode"])("th",{colspan:"2"})],-1)),h={scope:"col",class:"bg-light"},N={class:"tableTitle"},u=i(()=>Object(o["createElementVNode"])("span",null,"交易日期",-1)),j={scope:"col"},g={class:"tableTitle"},_=i(()=>Object(o["createElementVNode"])("span",null,"會員編號",-1)),y={scope:"col"},R={class:"tableTitle"},S=i(()=>Object(o["createElementVNode"])("span",null,"會員名稱",-1)),D={scope:"col"},V={class:"tableTitle"},I=i(()=>Object(o["createElementVNode"])("span",null,"銷售金額",-1)),C={scope:"col"},T={class:"tableTitle"},A=i(()=>Object(o["createElementVNode"])("span",null,"發行點數",-1)),f={scope:"col"},k={class:"tableTitle"},v=i(()=>Object(o["createElementVNode"])("span",null,"兌換點數",-1)),P=i(()=>Object(o["createElementVNode"])("th",{scope:"col",class:"tableTitle"},"點數異動明細",-1)),U={key:0},L=i(()=>Object(o["createElementVNode"])("th",{class:"bg-white"},"總計",-1)),w=i(()=>Object(o["createElementVNode"])("td",{class:"text-center"},"-",-1)),B=i(()=>Object(o["createElementVNode"])("td",{class:"text-center"},"-",-1)),M=i(()=>Object(o["createElementVNode"])("td",{class:"text-center"},"-",-1)),x={class:"text-start bg-white"},G={class:"text-start"},F={class:"text-start"},Y={class:"d-center"},H=["onClick"],K=i(()=>Object(o["createElementVNode"])("span",{class:"text-decoration-underline text-info"},"查看更多",-1)),W=[K];function J(e,t,a,c,n,s){const l=Object(o["resolveComponent"])("ExportToExcel");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[e.shop_pointsUsage.length>0?(Object(o["openBlock"])(),Object(o["createBlock"])(l,{key:0,fileName:e.shop_pointInfo.shop+"_門市點數履歷",sheetName:e.shop_pointInfo.shop+"_門市點數履歷",mergeArray:n.mergeArray,tableInfo:e.shop_pointInfo},null,8,["fileName","sheetName","mergeArray","tableInfo"])):Object(o["createCommentVNode"])("",!0),Object(o["createElementVNode"])("div",m,[Object(o["createElementVNode"])("table",b,[Object(o["createElementVNode"])("thead",p,[O,E,Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",h,[Object(o["createElementVNode"])("div",N,[u,Object(o["createElementVNode"])("button",{type:"button",class:"btn ri-sort-desc",onClick:t[0]||(t[0]=(...e)=>s.sortData&&s.sortData(...e)),"data-sort-item":"sale_date"})])]),Object(o["createElementVNode"])("th",j,[Object(o["createElementVNode"])("div",g,[_,Object(o["createElementVNode"])("button",{type:"button",class:"btn ri-sort-desc",onClick:t[1]||(t[1]=(...e)=>s.sortData&&s.sortData(...e)),"data-sort-member-id":"member"})])]),Object(o["createElementVNode"])("th",y,[Object(o["createElementVNode"])("div",R,[S,Object(o["createElementVNode"])("button",{type:"button",class:"btn ri-sort-desc",onClick:t[2]||(t[2]=(...e)=>s.sortData&&s.sortData(...e)),"data-sort-member-name":"member"})])]),Object(o["createElementVNode"])("th",D,[Object(o["createElementVNode"])("div",V,[I,Object(o["createElementVNode"])("button",{type:"button",class:"btn ri-sort-desc",onClick:t[3]||(t[3]=(...e)=>s.sortData&&s.sortData(...e)),"data-sort-item":"total_sale_amount"})])]),Object(o["createElementVNode"])("th",C,[Object(o["createElementVNode"])("div",T,[A,Object(o["createElementVNode"])("button",{type:"button",class:"btn ri-sort-desc",onClick:t[4]||(t[4]=(...e)=>s.sortData&&s.sortData(...e)),"data-sort-item":"total_send_points"})])]),Object(o["createElementVNode"])("th",f,[Object(o["createElementVNode"])("div",k,[v,Object(o["createElementVNode"])("button",{type:"button",class:"btn ri-sort-desc",onClick:t[5]||(t[5]=(...e)=>s.sortData&&s.sortData(...e)),"data-sort-item":"total_redeem_points"})])]),P])]),e.shop_pointsUsage.length>0?(Object(o["openBlock"])(),Object(o["createElementBlock"])("tbody",U,[Object(o["createElementVNode"])("tr",null,[L,w,B,Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(parseInt(e.shop_sumOfPointsUsage.total_sale_amount).toLocaleString()),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.shop_sumOfPointsUsage.total_send_points),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.shop_sumOfPointsUsage.total_redeem_points),1),M]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(n.shopPointsUsage,t=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:t},[Object(o["createElementVNode"])("th",x,Object(o["toDisplayString"])(t.sale_date),1),Object(o["createElementVNode"])("td",G,Object(o["toDisplayString"])(t.member.id),1),Object(o["createElementVNode"])("td",F,Object(o["toDisplayString"])(t.member.name),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(parseInt(t.total_sale_amount).toLocaleString()),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.total_send_points.toLocaleString()),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.total_redeem_points.toLocaleString()),1),Object(o["createElementVNode"])("td",Y,[Object(o["createElementVNode"])("button",{type:"button",class:"btn btn-outline-info border-0",onClick:a=>e.$emit("viewDetail",t)},W,8,H)])]))),128))])):Object(o["createCommentVNode"])("",!0)],512)])],64)}var $=a("dd88"),X=a("5502"),q=a("45c2"),z={data(){return{mergeArray:["C1","D1","E1","F1","B2"],shopPointsUsage:""}},emits:["viewDetail"],components:{ExportToExcel:q["a"]},watch:{shop_pointsUsage:{immediate:!0,deep:!0,handler(){""!==this.shop_pointsUsage&&(this.shopPointsUsage=JSON.parse(JSON.stringify(this.shop_pointsUsage)))}},shop_pointInfo:{immediate:!0,deep:!0,handler(){}}},computed:{...Object(X["c"])(["shop_sumOfPointsUsage","shop_pointsUsage","shop_pointInfo"])},methods:{sortData(e){this.shopPointsUsage=Object($["a"])(e,this.shopPointsUsage)}}},Q=(a("7200"),a("6b0d")),Z=a.n(Q);const ee=Z()(z,[["render",J],["__scopeId","data-v-1ac11ddc"]]);var te=ee;const ae=e=>(Object(o["pushScopeId"])("data-v-01654ceb"),e=e(),Object(o["popScopeId"])(),e),oe={class:"d-flex justify-content-between"},ce=ae(()=>Object(o["createElementVNode"])("i",{class:"bx bx-left-arrow-alt fs-small"},null,-1)),ne={class:"table-responsive"},se={class:"reportTable table table-hover table-bordered table-bordered",ref:"table"},le={class:"bg-light"},re=ae(()=>Object(o["createElementVNode"])("tr",{class:"d-none"},[Object(o["createElementVNode"])("th",{colspan:"3"},"門市點數履歷詳細資料")],-1)),de=ae(()=>Object(o["createElementVNode"])("tr",{class:"d-none"},[Object(o["createElementVNode"])("th",{colspan:"2"})],-1)),ie=ae(()=>Object(o["createElementVNode"])("th",{scope:"col",class:"tableTitle bg-light"},"排序",-1)),me={scope:"col"},be={class:"tableTitle"},pe=ae(()=>Object(o["createElementVNode"])("span",null,"類型",-1)),Oe={scope:"col"},Ee={class:"tableTitle"},he=ae(()=>Object(o["createElementVNode"])("span",null,"點數",-1)),Ne={scope:"row",class:"bg-white"},ue={class:"text-start"};function je(e,t,a,c,n,s){const l=Object(o["resolveComponent"])("ExportToExcel");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createElementVNode"])("div",oe,[Object(o["createElementVNode"])("button",{class:"btn btn-outline-primary fs-small d-center py-1 px-2 mb-2 btn-border-color",onClick:t[0]||(t[0]=t=>e.$emit("goBack"))},[ce,Object(o["createTextVNode"])(" 回上層 ")]),Object(o["createVNode"])(l,{fileName:e.shop_pointInfo.shop+"_門市點數履歷詳細資料",sheetName:e.shop_pointInfo.shop+"_門市點數履歷詳細資料",mergeArray:n.mergeArray,tableInfo:e.tableInfo},null,8,["fileName","sheetName","mergeArray","tableInfo"])]),Object(o["createElementVNode"])("div",ne,[Object(o["createElementVNode"])("table",se,[Object(o["createElementVNode"])("thead",le,[re,de,Object(o["createElementVNode"])("tr",null,[ie,Object(o["createElementVNode"])("th",me,[Object(o["createElementVNode"])("div",be,[pe,Object(o["createElementVNode"])("button",{type:"button",class:"btn ri-sort-desc px-1",onClick:t[1]||(t[1]=(...e)=>s.sortData&&s.sortData(...e)),"data-sort-item":"type"})])]),Object(o["createElementVNode"])("th",Oe,[Object(o["createElementVNode"])("div",Ee,[he,Object(o["createElementVNode"])("button",{type:"button",class:"btn ri-sort-desc px-1",onClick:t[2]||(t[2]=(...e)=>s.sortData&&s.sortData(...e)),"data-sort-item":"points"})])])])]),Object(o["createElementVNode"])("tbody",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(n.detailData,(e,t)=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:e},[Object(o["createElementVNode"])("th",Ne,Object(o["toDisplayString"])(t+1),1),Object(o["createElementVNode"])("td",ue,Object(o["toDisplayString"])(n.translate(e.type)),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.points.toLocaleString()),1)]))),128))])],512)])],64)}var ge=a("c457"),_e={data(){return{detailData:{},mergeArray:["B1","C1","D1","B2"],sale_date:"",detailInfo:{},member:"",translate:ge["a"]}},components:{ExportToExcel:q["a"]},computed:{...Object(X["c"])(["shop_pointInfo"])},emits:["goBack"],props:["data"],watch:{data:{immediate:!0,deep:!0,handler(){this.detailProcessing(this.data)}}},methods:{sortData(e){this.detailData=Object($["a"])(e,this.detailData)},detailProcessing(e){this.detailData=e.details,this.sale_date=e.sale_date,this.member=e.member.name,this.tableInfo=JSON.parse(JSON.stringify(this.shop_pointInfo)),this.tableInfo.dateRange=this.sale_date,this.tableInfo.member=this.member,this.detailData=Object(ge["a"])(this.detailData)}}};a("d190");const ye=Z()(_e,[["render",je],["__scopeId","data-v-01654ceb"]]);var Re=ye;const Se=e=>(Object(o["pushScopeId"])("data-v-48e1900d"),e=e(),Object(o["popScopeId"])(),e),De={class:"container py-5"},Ve={class:"row ps-0 ps-md-3 ps-lg-0"},Ie={class:"col-md-12"},Ce={class:"row mb-4 ps-0 ps-lg-4 ps-xl-0"},Te=Se(()=>Object(o["createElementVNode"])("label",{class:"col-xl-2 col-form-label required-input text-start text-xl-end"},[Object(o["createElementVNode"])("span",null,"*"),Object(o["createTextVNode"])("選擇門市別:")],-1)),Ae={class:"col-xl-10"},fe={class:"dropdown-company-menu dropdown-menu w-100"},ke={class:"row"},ve={class:"col-3 border-end"},Pe={class:"p-2 pt-1 searchlist-input"},Ue={class:"limitDropDown list-unstyled dropdown-list ps-2 mb-0"},Le={class:"d-between px-0 py-2"},we={class:"companyItem"},Be=["data-company-id","data-company-name","value","id","checked"],Me=["for"],xe={class:"col-9"},Ge={class:"searchlist-input pe-2 py-1 mb-2"},Fe={class:"d-flex justify-content-end border-bottom pb-2 mb-3"},Ye=["checked"],He=Se(()=>Object(o["createElementVNode"])("label",{class:"btn btn-outline-secondary radioBtn fs-small text-nowrap mb-0 px-3 py-1 mx-3",for:"allStoreType"},"全部",-1)),Ke=["checked"],We=Se(()=>Object(o["createElementVNode"])("label",{class:"btn btn-outline-secondary radioBtn fs-small text-nowrap mb-0 px-3 py-1 me-3",for:"voluntaryStoreType"},"直營",-1)),Je=["checked"],$e=Se(()=>Object(o["createElementVNode"])("label",{class:"btn btn-outline-secondary radioBtn fs-small text-nowrap mb-0 px-3 py-1 me-3",for:"franchiseStoreType"},"加盟",-1)),Xe={class:"limitDropDown filterAccordion accordion list-unstyled mb-0"},qe={key:0,class:"accordion-item ps-2"},ze={class:"d-between"},Qe={class:"ps-2"},Ze=["data-bs-target","aria-controls"],et=["id","aria-labelledby"],tt={class:"accordion-body row py-2"},at=["value","id","onClick"],ot=["for"],ct={class:"col-xl-6"},nt={class:"row mb-4"},st=Se(()=>Object(o["createElementVNode"])("label",{class:"col-lg-2 col-xl-4 col-form-label required-input text-start text-lg-end pe-0"},[Object(o["createElementVNode"])("span",null,"*"),Object(o["createTextVNode"])("交易日期:")],-1)),lt={class:"col-lg-10 col-xl-8"},rt={class:"d-flex align-items-center"},dt={class:"input-group d-flex"},it=Se(()=>Object(o["createElementVNode"])("i",{class:"ri-calendar-2-line"},null,-1)),mt=[it],bt=Se(()=>Object(o["createElementVNode"])("span",{class:"mx-2"},"至",-1)),pt={class:"input-group d-flex"},Ot=Se(()=>Object(o["createElementVNode"])("i",{class:"ri-calendar-2-line"},null,-1)),Et=[Ot],ht={class:"d-flex mt-3"},Nt=Se(()=>Object(o["createElementVNode"])("label",{class:"btn btn-outline-secondary radioBtn me-2 me-md-3",for:"dateRangeToday"},"今",-1)),ut=Se(()=>Object(o["createElementVNode"])("label",{class:"btn btn-outline-secondary radioBtn me-2 me-md-3",for:"dataRangeYesterday"},"昨",-1)),jt=Se(()=>Object(o["createElementVNode"])("label",{class:"btn btn-outline-secondary radioBtn me-2 me-md-3",for:"dataRangeOneWeek"},"近7天",-1)),gt=Se(()=>Object(o["createElementVNode"])("label",{class:"btn btn-outline-secondary radioBtn",for:"dataRangeOneMonth"},"近30天",-1)),_t={class:"d-end"},yt=["disabled"];function Rt(e,t,a,c,n,s){const l=Object(o["resolveComponent"])("FlatPickr");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",De,[Object(o["createElementVNode"])("div",Ve,[Object(o["createElementVNode"])("div",Ie,[Object(o["createElementVNode"])("div",Ce,[Te,Object(o["createElementVNode"])("div",Ae,[Object(o["createElementVNode"])("input",{type:"text",class:Object(o["normalizeClass"])(["form-control rounded-end select-store-input",{"border-danger":!n.selectedStore}]),readonly:"",placeholder:"請選擇門市別(單選)","data-bs-toggle":"dropdown","data-bs-auto-close":"outside","aria-expanded":"false",ref:"dropdownList",role:"button"},null,2),Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(["invalid-feedback",{"d-block":!n.selectedStore,"d-none":n.selectedStore}])}," 此欄位為必填 ",2),Object(o["createElementVNode"])("div",fe,[Object(o["createElementVNode"])("div",ke,[Object(o["createElementVNode"])("div",ve,[Object(o["createElementVNode"])("div",Pe,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>n.companyKeyWord=e),class:"form-control form-control-sm border search-countryList",placeholder:"查詢公司關鍵字"},null,512),[[o["vModelText"],n.companyKeyWord]])]),Object(o["createElementVNode"])("ul",Ue,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(s.filterCompanyList,e=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{key:e.id,class:"form-check border-bottom py-2 mb-2"},[Object(o["createElementVNode"])("div",Le,[Object(o["createElementVNode"])("div",we,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-check-input","onUpdate:modelValue":t[1]||(t[1]=e=>n.selectedParams.company_id=e),type:"radio",name:"selectCompanyRadio","data-company-id":e.id,"data-company-name":e.name,value:e.id,id:"select"+e.name,checked:n.selectedCompanyId==e.id,onClick:t[2]||(t[2]=(...e)=>s.setCompanyInfo&&s.setCompanyInfo(...e))},null,8,Be),[[o["vModelRadio"],n.selectedParams.company_id]]),Object(o["createElementVNode"])("label",{class:"form-check-label",for:"select"+e.name},Object(o["toDisplayString"])(e.name),9,Me)]),Object(o["createElementVNode"])("i",{class:Object(o["normalizeClass"])(["las la-angle-right",{"d-inline-block":n.selectedCompanyId==e.id,"d-none":n.selectedCompanyId!==e.id}])},null,2)])]))),128))])]),Object(o["createElementVNode"])("div",xe,[Object(o["createElementVNode"])("div",Ge,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>n.storeGroupKeyWord=e),class:"form-control form-control-sm border search-countryList",placeholder:"搜尋區域或門市"},null,512),[[o["vModelText"],n.storeGroupKeyWord]])]),Object(o["createElementVNode"])("div",Fe,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=e=>n.storeType=e),id:"allStoreType",class:"btn-check",onClick:t[5]||(t[5]=e=>s.getStoresGroup("ALL")),value:"ALL",name:"storeTypeRadio",autocomplete:"off",checked:"ALL"==this.storeType},null,8,Ye),[[o["vModelRadio"],n.storeType]]),He,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"radio","onUpdate:modelValue":t[6]||(t[6]=e=>n.storeType=e),id:"voluntaryStoreType",class:"btn-check",onClick:t[7]||(t[7]=e=>s.getStoresGroup("VOLUNTARY_CHAIN")),value:"VOLUNTARY_CHAIN",name:"storeTypeRadio",autocomplete:"off",checked:"VOLUNTARY_CHAIN"==this.storeType},null,8,Ke),[[o["vModelRadio"],n.storeType]]),We,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"radio","onUpdate:modelValue":t[8]||(t[8]=e=>n.storeType=e),id:"franchiseStoreType",class:"btn-check",onClick:t[9]||(t[9]=e=>s.getStoresGroup("FRANCHISE_CHAIN")),value:"FRANCHISE_CHAIN",name:"storeTypeRadio",autocomplete:"off",checked:"FRANCHISE_CHAIN"==this.storeType},null,8,Je),[[o["vModelRadio"],n.storeType]]),$e]),Object(o["createElementVNode"])("ul",Xe,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(s.filterStoresGroup,e=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{key:e.id,class:"mb-3"},[e.stores.length>0?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",qe,[Object(o["createElementVNode"])("div",ze,[Object(o["createElementVNode"])("p",Qe,Object(o["toDisplayString"])(e.name),1),Object(o["createElementVNode"])("button",{class:"accordion-button",type:"button","data-bs-toggle":"collapse","data-bs-target":"#areaAccoddion"+e.id,"aria-expanded":"true","aria-controls":"areaAccoddion"+e.id},null,8,Ze)]),Object(o["createElementVNode"])("div",{id:"areaAccoddion"+e.id,class:"accordion-collapse collapse show px-3","aria-labelledby":"areaAccordion"+e.id},[Object(o["createElementVNode"])("ul",tt,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.stores,e=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{key:e.id,class:"form-check col-4"},[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-check-input","onUpdate:modelValue":t[10]||(t[10]=e=>n.selectedParams.store_id=e),type:"radio",name:"selectStoreRadio",value:e.id,id:"select"+e.id,onClick:t=>s.setSelectedStore(e)},null,8,at),[[o["vModelRadio"],n.selectedParams.store_id]]),Object(o["createElementVNode"])("label",{class:"form-check-label",for:"select"+e.id},Object(o["toDisplayString"])(e.id)+" "+Object(o["toDisplayString"])(e.name),9,ot)]))),128))])],8,et)])):Object(o["createCommentVNode"])("",!0)]))),128))])])])])])])]),Object(o["createElementVNode"])("div",ct,[Object(o["createElementVNode"])("div",nt,[st,Object(o["createElementVNode"])("div",lt,[Object(o["createElementVNode"])("div",rt,[Object(o["createElementVNode"])("div",dt,[Object(o["createVNode"])(l,{modelValue:n.dateRange.start,"onUpdate:modelValue":t[11]||(t[11]=e=>n.dateRange.start=e),config:s.dateRangeStart,onOnChange:t[12]||(t[12]=e=>s.changeDateRange("start")),onClick:t[13]||(t[13]=e=>n.changeDateStatus=!0),role:"button",class:Object(o["normalizeClass"])(["form-control rounded-start",{"border-danger":!n.dateRange.start}]),placeholder:"開始日期",ref:"date"},null,8,["modelValue","config","class"]),n.isMobile?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("button",{key:0,class:Object(o["normalizeClass"])(["btn toggleCalendar",{"border-danger":!n.dateRange.start}]),title:"Toggle","data-toggle":""},mt,2))]),bt,Object(o["createElementVNode"])("div",pt,[Object(o["createVNode"])(l,{modelValue:n.dateRange.end,"onUpdate:modelValue":t[14]||(t[14]=e=>n.dateRange.end=e),config:s.dateRangeEnd,onOnChange:t[15]||(t[15]=e=>s.changeDateRange("end")),onClick:t[16]||(t[16]=e=>n.changeDateStatus=!0),role:"button",class:Object(o["normalizeClass"])(["form-control rounded-start",{"border-danger":!n.dateRange.end}]),placeholder:"結束日期"},null,8,["modelValue","config","class"]),n.isMobile?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("button",{key:0,class:Object(o["normalizeClass"])(["btn toggleCalendar",{"border-danger":!n.dateRange.end}]),title:"Toggle","data-toggle":""},Et,2))])]),Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(["invalid-feedback",{"d-none":n.dateRange.start&&n.dateRange.end,"d-block":!n.dateRange.start&&!n.dateRange.end}])}," 此欄位為必填 ",2),Object(o["createElementVNode"])("div",ht,[Object(o["createElementVNode"])("input",{type:"radio",class:"btn-check",onClick:t[17]||(t[17]=e=>s.setDateRange("today")),value:"今",name:"dateRangeRadio",id:"dateRangeToday"}),Nt,Object(o["createElementVNode"])("input",{type:"radio",class:"btn-check",onClick:t[18]||(t[18]=e=>s.setDateRange("yesterday")),value:"昨",name:"dateRangeRadio",id:"dataRangeYesterday"}),ut,Object(o["createElementVNode"])("input",{type:"radio",class:"btn-check",onClick:t[19]||(t[19]=e=>s.setDateRange("week")),value:"近7天",name:"dateRangeRadio",id:"dataRangeOneWeek"}),jt,Object(o["createElementVNode"])("input",{type:"radio",class:"btn-check",onClick:t[20]||(t[20]=e=>s.setDateRange("month")),value:"近30天",name:"dateRangeRadio",id:"dataRangeOneMonth"}),gt])])])])]),Object(o["createElementVNode"])("div",_t,[Object(o["createElementVNode"])("button",{class:"btn me-4 pb-0 text-decoration-underline",type:"button",onClick:t[21]||(t[21]=(...e)=>s.reset&&s.reset(...e))}," 清空搜尋條件 "),Object(o["createElementVNode"])("button",{class:"btn btn-primary text-white",type:"button",onClick:t[22]||(t[22]=(...e)=>s.goSearch&&s.goSearch(...e)),disabled:!n.dateRange.start||!n.dateRange.end||!n.selectedParams.store_id}," 查詢 ",8,yt)])])}a("14d9");var St=a("c38f"),Dt=a.n(St),Vt=(a("0952"),a("c535")),It=a("9dab"),Ct={data(){return{isMobile:!1,defaultCompanyId:Object(It["b"])("company"),selectedCompanyName:"",selectedCompanyId:"",selectedStore:!0,companyKeyWord:"",storeGroupKeyWord:"",storeType:"ALL",changeDateStatus:!0,dateRange:{start:new Date((new Date).getFullYear(),(new Date).getMonth(),1),end:"today"},tempDateRange:{start:new Date((new Date).getFullYear(),(new Date).getMonth(),1),end:Object(Vt["g"])(new Date)},selectedParams:{company_id:"",store_id:"",start_date:"",end_date:""}}},components:{FlatPickr:Dt.a},watch:{selectedCompanyId:{immediate:!0,handler(){""!==this.selectedCompanyId&&this.changeTargetCompany(this.selectedCompanyId)}}},computed:{...Object(X["c"])(["companyList","areaList","cityList","administrativeList","stores","companyId","getStoresByGroup"]),dateRangeStart(){const e=new Date(this.dateRange.end);if("Invalid Date"!=e)return{minDate:new Date(e.getFullYear()-2,e.getMonth(),e.getDate()),maxDate:this.dateRange.end?this.dateRange.end:"today",dateFormat:"Y-m-d",wrap:!0}},dateRangeEnd(){return{minDate:this.dateRange.start,maxDate:"today",dateFormat:"Y-m-d",wrap:!0}},filterCompanyList(){if(Array.isArray(this.companyList)){const e=JSON.parse(JSON.stringify(this.companyList)),t=e.filter(e=>e.name.match(this.companyKeyWord)||e.id.match(this.companyKeyWord));return this.selectedCompanyId=t[0].id,t}return[]},filterStoresGroup(){if(Array.isArray(this.getStoresByGroup)){const e=JSON.parse(JSON.stringify(this.getStoresByGroup)),t=[];return e.forEach(e=>{if(e.name.match(this.storeGroupKeyWord)||e.id.match(this.storeGroupKeyWord))t.push(e);else{const a={id:e.id,name:e.name,stores:[]};e.stores.forEach(e=>{if(e.name.match(this.storeGroupKeyWord)||e.id.match(this.storeGroupKeyWord)){const t={id:e.id,name:e.name};a.stores.push(t)}}),a.stores.length>0&&t.push(a)}}),t}return[]}},methods:{getCompanyList(){this.$store.dispatch("getCompanyList"),setTimeout(()=>{this.selectedCompanyName=this.companyList[0].name,this.selectedCompanyId=this.companyList[0].id,this.setStoreGroup(this.companyList[0])},500)},getStoresGroup(e="ALL"){const t={company_id:this.selectedCompanyId,store_type:e};this.$store.dispatch("getStoresByGroup",t)},setCompanyInfo(e){e.stopPropagation();const t=e.target.getAttribute("data-company-name");this.selectedCompanyName=t,this.selectedCompanyId=e.target.value,this.storeType="ALL",document.querySelector("input[name='selectStoreRadio']:checked")&&(document.querySelector("input[name='selectStoreRadio']:checked").checked=!1),document.querySelector(".select-store-input").value="",this.getStoresGroup()},setStoreGroup(e){this.selectedCompanyName=e.name,this.selectedCompanyId=e.id,this.selectedParams.store_type="ALL",this.getStoresGroup()},setSelectedStore(e){document.querySelector(".select-store-input").value=`${this.selectedCompanyName} - ${e.id} ${e.name}`},setDateRange(e){switch(e){case"today":this.dateRange.start=Object(Vt["g"])(new Date),this.dateRange.end=Object(Vt["g"])(new Date);break;case"yesterday":this.dateRange.start=Object(Vt["g"])(Object(Vt["d"])(new Date,1)),this.dateRange.end=Object(Vt["g"])(Object(Vt["d"])(new Date,1));break;case"week":this.dateRange.start=Object(Vt["g"])(Object(Vt["d"])(new Date,6)),this.dateRange.end=Object(Vt["g"])(new Date);break;case"month":this.dateRange.start=Object(Vt["g"])(Object(Vt["d"])(new Date,29)),this.dateRange.end=Object(Vt["g"])(new Date);break;default:break}this.tempDateRange=JSON.parse(JSON.stringify(this.dateRange)),this.selectedParams.start_date=this.dateRange.start,this.selectedParams.end_date=this.dateRange.end},removeDateRangeRadio(){const e=document.querySelector('input[name="dateRangeRadio"]:checked');e&&(this.dateRange.start===this.tempDateRange.start&&this.dateRange.end===this.tempDateRange.end||(e.checked=!1))},changeDateRange(e){if(!this.changeDateStatus)return;"end"===e&&this.removeDateRangeRadio();const t=new Date(this.dateRange.start),a=new Date(this.dateRange.end),o=a-t,c=o/31536e6;c>2&&this.dateRange.start&&this.dateRange.end&&(this.changeDateStatus=!1,"end"==e?this.dateRange.start=new Date(a.getFullYear()-2,a.getMonth(),a.getDate()):this.dateRange.end=new Date(t.getFullYear()+2,t.getMonth(),t.getDate()))},changeTargetCompany(e){this.selectedCompanyId=e,this.getStoresGroup()},reset(){this.companyList.length>1&&(this.selectedCompanyName="",this.selectedCompanyId="",document.querySelector(".select-store-input").value="",this.selectedParams.company_id=""),this.selectedStore=!1,this.selectedParams.store_id="",this.removeDateRangeRadio(),this.$store.commit("SET_SHOP_SUMPOINTSUSAGE",""),this.$store.commit("SET_SHOP_POINTSUSAGE",""),this.tempDateRange=JSON.parse(JSON.stringify(this.dateRange)),this.dateRange.start=null,this.dateRange.end=null},goSearch(){this.selectedParams.company_id=this.selectedCompanyId,this.selectedParams.start_date=this.dateRange.start,this.selectedParams.end_date=this.dateRange.end,this.$emit("search-shop-point",this.selectedParams)}},mounted(){this.$refs.date.fp.isMobile&&(this.isMobile=!0),this.getCompanyList(),this.dateRange.start=Object(Vt["g"])(new Date((new Date).getFullYear(),(new Date).getMonth(),1)),this.dateRange.end=Object(Vt["g"])(new Date),this.$refs.dropdownList.addEventListener("hide.bs.dropdown",()=>{const e=document.querySelectorAll("input[name='selectStoreRadio']:checked");0===e.length?this.selectedStore=!1:this.selectedStore=!0,this.companyKeyWord="",this.storeGroupKeyWord=""})}};a("223e");const Tt=Z()(Ct,[["render",Rt],["__scopeId","data-v-48e1900d"]]);var At=Tt,ft={data(){return{showDetail:!1,detailData:{},title:"門市點數履歷",items:[{text:"商務分析報表",href:"/"},{text:"門市點數履歷",active:!0}]}},components:{Layout:r["a"],PageHeader:d["a"],ShopPoint:te,ShopPointDetail:Re,FilterField:At},methods:{getShopPoint(e){this.$store.dispatch("setLoading"),this.$store.dispatch("getStorePoints",e)},viewDetail(e,t){this.showDetail=!0,this.detailData=JSON.parse(JSON.stringify(e)),this.detailData.memberName=t}},computed:{...Object(X["c"])(["shop_pointsUsage","shop_pointInfo"])},beforeRouteEnter(e,t,a){a(e=>{e.$store.commit("SET_SHOP_SUMPOINTSUSAGE",""),e.$store.commit("SET_SHOP_POINTSUSAGE","")})}};const kt=Z()(ft,[["render",l]]);t["default"]=kt},7200:function(e,t,a){"use strict";a("82ce")},"82ce":function(e,t,a){},"8f6e":function(e,t,a){},c457:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));const o={"當期":"PRIOR_PERIOD","同期":"SAME_PERIOD","前期":"PRIOR_PERIOD","大分類":"CATEGORY_GROUP","中分類":"CATEGORY","小分類":"CATEGORY_ITEM","商品":"PRODUCT","營業額 x 銷售量":"REVENUE_AND_SALES_VOLUME","營業額 x 毛利率":"SALES_VOLUME_AND_REVENUE","毛利率 x 銷售量":"SALES_VOLUME_AND_REVENUE","營業額 x 毛利額":"SALES_VOLUME_AND_REVENUE",NEW_CONSUMPTION:"消費新增",SALES_RETURN_REDUCTION:"銷退返還",EXCHANGE:"點數兌換",EXCHANGE_SELL_BACK:"點數兌換銷退",TRANSFER_OUT:"點數轉出",TRANSFER_IN:"點數轉入",ACTIVITY_DEDUCTION_POINTS:"活動扣點",ACTIVITY_ACCUMULATED_POINTS:"活動累點",ZERO:"點數歸零",FORCE_PRINTING:"強制列印",FORCE_INVOICING:"強制開立發票",DEFAULT_INVOICING:"預設開立發票",DEFAULT_NOT_INVOICE:"預設不開立發票",DEFAULT_PRINTING:"預設列印",DEFAULT_NOT_PRINT:"預設不列印",PRINT_DETAIL:"列印明細",PRINT_TOTAL:"列印總額",STORE_ID:"店號",STORE_SHORT_NAME:"門市簡稱",SOFTWARE_DRIVER:"軟體驅動",HARDWARE_DRIVER:"硬體驅動",ROUND_HALF_UP:"四捨五入",ROUND_HALF_DOWN:"五捨六入",ROUND_UP:"無條件進位",ROUND_DOWN:"無條件捨去",CUSTOM:"自訂",CAN_NOT_CHECKOUT:"無法結帳",NOT_INPUT:"不輸入",INPUT_RETURN_REASON:"輸入退貨原因",SHOW_MESSAGE:"顯示訊息",UNIFORM_PRICE:"統一價格",PRICE_AREA:"價格區",STORE_PRICE:"門市金額",DEFAULT:"系統預設",CATEGORY:"類別",ORDER_AREA:"菜單",Quantity:"數量",PRODUCT_CATEGORY:"依類別",PRODUCT_TYPE:"依性質",PRODUCT:"依商品",SALE_METHOD:"依銷售方式",SALE_METHOD_AND_PRODUCT_CATEGORY:"依銷售方式 + 類別",SALE_METHOD_AND_PRODUCT_TYPE:"依銷售方式 + 性質",SALE_METHOD_AND_PRODUCT:"依銷售方式 + 商品",MAIN_NAME:"商品名稱",SECOND_NAME:"第二名稱",SHORT_NAME:"簡稱",TAG:"標籤",KITCHEN_ORDER:"廚房單",KITCHEN_SUMMARY_ORDER:"廚房總單",SALE_DATE:"銷售日期",SALE_TIME:"銷售時間",TAKE_NO:"取餐號碼",MACHINE_ID:"機號",SALES_ORDER:"銷貨單",CUSTOMER_ORDER:"客戶訂貨單",TICKET_SALES:"票券銷售",INVOICE_SUMMARY:"發票彙開",POSTING:"補登",PLATFORM_BUSINESS:"平台商",MOBILE_OR_TELEPHONE:"手機號碼/電話",VIP_ID:"會員編號",QR_CODE:"QR-Code",BLESSING:"祝福語",PICKUP_TIME:"取餐時間",MEMO:"整單備註",SEQUENCE:"順序",UNUSED:"未使用",USING:"使用中",USED:"已使用",CREATED:"建立",ISSUED:"開立",NORMAL:"正常",VOID:"作廢",BLANK:"空白",TAXABLE:"應稅",TAX_EXEMPT:"免稅",ZERO_TAX:"零稅","應稅":"TAXABLE","免稅":"TAX_EXEMPT","零稅":"ZERO_TAX",SALES_ORDER:"銷貨單",BY_CHECKOUT_TIME:"依結帳時間",BY_CLEARING_TABLE_TIME:"依清桌時間",BY_SUMMARIZING_ORDERS:"依單據彙總",BY_SUMMARIZING_ITEMS:"依品項彙總",BY_BREAKING_ITEMS_DOWN:"依品項展開",BY_SUMMARIZING_ORDERS_AND_BREAKING_ITEM:"依單據彙總 + 品項展開",CUP_QUANTITY:"杯數",SALE_PRICE:"售價",TABLE_NO:"桌號",USER_NAME:"收銀員名稱",DEMOGRAPHIC:"客層",TOTAL_QUANTITY:"總數量",PRODUCT_ELEMENT:"商品成份",NOT_SET:"未設定",RECEIPT_PRINTER:"收據出單機",INVOICE_PRINTER:"發票出單機",MACHINE_CONFIG:"機台設定",RECEIPT_CONFIG:"發票設定",PARAMS_CONFIG:"參數設定",POS_CONFIG:"收銀設定",ACCOUNT_CONFIG:"帳條設定",ORDER_CONFIG:"接單設定",DEVICE_CONFIG:"裝置設定",PAYMENT_CONFIG:"門店管理付款方式設定",INVOICE_BUYS_CONFIG:"發票購入維護",INVOICE_ISSUANCE_CONFIG:"發票開立維護",NOT_PRINT:"一律不列印",PENDING_ORDER_NOT_PRINT:"掛單不列印(其他流程依參數設定決定)",BY_QUERY_WINDOW:"依詢問視窗選擇",CANCEL_ORDER:"一律取消訂單",PICK_WRONG_ORDER:"一律視為取錯單",BY_MACHINE_CONFIG:"依[裝置設定]參數設定",ACTIVE:"已生效",INACTIVE:"未生效",EXPIRED:"已過期",SPECIAL_SALE:"特賣促銷"},c=e=>o[e]||e},d190:function(e,t,a){"use strict";a("8f6e")}}]);